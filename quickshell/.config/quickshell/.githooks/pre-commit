#!/usr/bin/env bash
set -euo pipefail

root="$(git rev-parse --show-toplevel)"
cd "$root"

# Validate Settings.json in repo
node quickshell/.config/quickshell/Tools/validate-settings.mjs \
  --settings quickshell/.config/quickshell/Settings.json \
  --schema quickshell/.config/quickshell/Docs/SettingsSchema.json

# Validate Theme.json in repo with constraints
node quickshell/.config/quickshell/Tools/validate-theme.mjs \
  --theme quickshell/.config/quickshell/Theme.json \
  --schema quickshell/.config/quickshell/Docs/ThemeHierarchical.json \
  --constraints quickshell/.config/quickshell/Docs/ThemeConstraints.json \
  --strict

echo "Running Settings linter (unknown keys will fail):"
node quickshell/.config/quickshell/Tools/lint-settings.mjs

echo "pre-commit: config validation passed."
