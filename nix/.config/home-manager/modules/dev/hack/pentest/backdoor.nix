{
  pkgs,
  lib,
  config,
  ...
}: let
  excluded = config.features.excludePkgs or [];
  notExcluded = p: let n = p.pname or (lib.getName p); in !(lib.elem n excluded);
  notBroken = p: !(((p.meta or {}).broken or false));
in {
  home.packages = lib.filter notBroken (lib.filter notExcluded (with pkgs; [
    # Bidirectional data stream tunnelled in HTTP requests
    httptunnel # bidirectional data stream tunneled over HTTP requests
    # dns2tcp # TCP over DNS tunnel client and server
    # exe2hexbat # Convert EXE to bat
    iodine # Tool for tunneling IPv4 data through a DNS server
    # laudanum # Collection of injectable web files
    # mimikatz # Uses admin rights on Windows to display passwords in plaintext
    miredo # Teredo IPv6 tunneling through NATs
    # nishang # Collection of PowerShell scripts and payloads
    # powersploit # PowerShell Post-Exploitation Framework
    # ptunnel # Tunnel TCP connections over ICMP packets
    # sbd # Secure backdoor for linux and windows
    # shellter
    # stunnel4 # Universal SSL tunnel for network daemons
    udptunnel # Tunnel UDP packets over a TCP connection
    # veil # Generates payloads to bypass anti-virus solutions
    # webacoo # Web backdoor cookie script kit
    # weevely # Stealth tiny web shell
    # Tool that allows any client behind a NAT to communicate
    # with a server behind a separate NAT with *no* port
    # forwarding and *no* DMZ setup on any routers in order to
    # directly communicate with each other
    pwnat # NAT traversal without port forwarding (UDP/ICMP tunneling)
  ]));
}
